(this["webpackJsonpmatx-react-pro"]=this["webpackJsonpmatx-react-pro"]||[]).push([[110],{3094:function(e,a,t){"use strict";t.r(a);var r=t(6),n=t(12),l=t(26),o=t(0),s=t.n(o),c=t(229),i=t.n(c),m=t(231),d=t(2302),u=t(224),p=t(606),b=t(64),g=t(1241),y=t(1201),h=(t(95),t(1153)),f=t(84),E=t(204),j=t(230),v=t(32),O=t(60),w=t(300),x=(t(443),t(1192)),R=t(2285),P=t(17),C=t(3),D=t(110),S=t(1196),N=t(765);Object(D.a)(e=>{e.palette,Object(l.a)(e,["palette"]);return{userMenu:{display:"flex",alignItems:"center",cursor:"pointer",borderRadius:24,padding:4,"& span":{margin:"0 8px"}},menuItem:{display:"flex",alignItems:"center",minWidth:185},userMenu:{display:"flex",alignItems:"center",cursor:"pointer",borderRadius:24,padding:4,"& span":{margin:"0 8px"}},menuItem:{display:"flex",alignItems:"center",minWidth:185}}});a.default=()=>{const e=Object(o.useState)({page:0,rowsPerPage:20,recherche:"",filtre:""}),a=Object(n.a)(e,2),t=a[0],l=a[1],c=Object(v.useQueryClient)(),D=Object(v.useQuery)(["Relances",t.page,t.rowsPerPage,t.recherche,t.filtre],()=>Object(N.b)(t.page,t.rowsPerPage,t.recherche,t.filtre),{keepPreviousData:!0}),M=D.isLoading,B=(D.isFetching,D.isError),k=D.error,I=D.data,F=Object(v.useMutation)(N.d,{onSuccess:()=>{H({message:"Suppr\xe9ssion r\xe9ussi",open:!0,severity:"success"})},onError:()=>{H({message:"Echec lors de l op\xe9ration",open:!0,severity:"error"})},onSettled:()=>{c.invalidateQueries("Relances")}}),Q=Object(o.useState)(null),T=Object(n.a)(Q,2),z=T[0],A=T[1],L=Object(o.useState)({mode:"affichage",action:"ajout",affichageTable:!0}),J=Object(n.a)(L,2),W=J[0],_=J[1],q=Object(o.useState)({severity:"severity",message:"",open:!1,handleCloseAlert:()=>te()}),Y=Object(n.a)(q,2),G=Y[0],H=Y[1],K=Object(o.useState)("Tableau des relances"),U=Object(n.a)(K,2),V=U[0],X=U[1],Z=Object(o.useState)(!1),$=Object(n.a)(Z,2),ee=$[0],ae=$[1],te=()=>{H(Object(r.a)(Object(r.a)({},f.a),{},{open:!1}))},re=[{name:"id",label:"ID",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>e}},{name:"contrat",label:"contrat",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"flex items-center"},s.a.createElement(d.a,{variant:"rounded",className:"w-48 h-48",src:P.f+"/fichiers/photoclient/"+a.rowData[8]}),s.a.createElement("div",{className:"ml-3"},s.a.createElement("h5",{className:"my-0 text-15"},("MALE"===e.client.civilite?"M. ":"Mme. ")+e.client.nom+" "),s.a.createElement("small",{className:"text-muted"},e.client.quartier.nom),s.a.createElement("br",null),s.a.createElement("small",{className:"text-muted"},e.numero))))}},{name:"daterelance",label:"Date de relance",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>s.a.createElement(s.a.Fragment,null," ",null==e?" ":Object(x.a)(Object(R.a)(e),"dd/MM/yyyy hh:mm"),s.a.createElement("br",null),s.a.createElement("small",{className:"text-muted"},"T\xe9l:"+a.rowData[1].client.telephone))}},{name:"nombredejoursimpaye",label:"impay\xe9 depuis",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>null===e||void 0===e?void 0:e.toLocaleString("fr-FR")}},{name:"raisondenonpayement",label:"Raison de non payement",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>e}},{name:"dateprevuedepayemebt",label:"payement pr\xe9vu le",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>null==e?" ":Object(x.a)(Object(R.a)(e),"dd/MM/yyyy hh:mm")}},{name:"statutdepayement",label:"Statut de payement",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>s.a.createElement("small",{className:Object(C.default)({"border-radius-4  text-white px-2 py-2px":!0,"bg-error":"Non pay\xe9"===e,"bg-green":"Pay\xe9"===e})},e)}},{name:"commentaire",label:"Commentaire",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>e}},{name:"action",label:"Actions",options:{filter:!1,sort:!1,display:"excluded",customBodyRender:(e,a,t)=>s.a.createElement("div",null,s.a.createElement(u.a,{size:"small",onClick:()=>{(e=>{_({mode:"edition",action:"misajour",affichageTable:!1}),A(e),X("Mise \xe0 jour de relance")})({id:a.rowData[0],contrat:a.rowData[1],daterelance:a.rowData[2],nombredejoursimpaye:a.rowData[3],raisondenonpayement:a.rowData[4],dateprevuedepayemebt:a.rowData[5],statutdepayement:a.rowData[6]})}},s.a.createElement(p.a,{color:"primary"},"edit")),s.a.createElement(u.a,{size:"small",onClick:()=>(e=>{ae(!0),A(e)})({id:a.rowData[0]})},s.a.createElement(p.a,{color:"error"},"delete")),s.a.createElement(u.a,{size:"small",onClick:()=>(a.rowData[0],void console.log("affichage de details"))},s.a.createElement(p.a,null,"arrow_right_alt")))}}];return s.a.createElement("div",{className:"m-sm-30"},s.a.createElement(f.a,{message:G.message,severity:G.severity,open:G.open,handleAlertClose:te}),s.a.createElement("div",{className:"mb-sm-30"},s.a.createElement(E.a,{routeSegments:[{name:"Relances de payement"}]})),s.a.createElement("div",{className:"mb-sm-30"},s.a.createElement(b.a,{variant:"h4"},V)),"affichage"===W.mode?s.a.createElement(g.a,{in:W.affichageTable,direction:"right",unmountOnExit:!0},s.a.createElement("div",null,M?s.a.createElement(O.a,{message:"Chargement des donn\xe9es",type:"info"}):B?s.a.createElement(O.a,{message:"Erreur lors du chargement des donn\xe9es::"+k,type:"error"}):s.a.createElement(w.a,{tag:"div",blocking:!1},s.a.createElement(S.a,{theme:Object(P.a)()},s.a.createElement(i.a,{title:V,data:I["hydra:member"],columns:re,options:Object(r.a)(Object(r.a)({},m.a),{},{serverSide:!0,count:I["hydra:totalItems"],rowsPerPageOptions:[20,30,50],rowsPerPage:t.rowsPerPage,onChangePage:e=>(e=>{l(Object(r.a)(Object(r.a)({},t),{},{page:e})),c.invalidateQueries("Relances")})(e),onChangeRowsPerPage:e=>(e=>{l(Object(r.a)(Object(r.a)({},t),{},{rowsPerPage:e})),console.log("idbre de ligne par page:"+e),c.invalidateQueries("Relances")})(e),onSearchChange:e=>(e=>{var a;l(Object(r.a)(Object(r.a)({},t),{},{recherche:null!==e&&void 0!==e?e:""})),console.log(null!==(a="texte a chercher"+e)&&void 0!==a?a:""),c.invalidateQueries("Relances")})(e),onFilterChange:()=>{console.log("le filtre a chang\xe9")}})}))),s.a.createElement(y.a,{className:"w-full overflow-auto",elevation:8},s.a.createElement(j.a,{open:ee,onConfirmDialogClose:()=>{ae(!1)},onYesClick:()=>{ae(!1),F.mutate(z)},text:"Confirmez la suppression de "+(null===z||void 0===z?void 0:z.name)})))):s.a.createElement(h.a,{action:W.action,lerelance:z,handleFermeture:()=>{_({mode:"affichage",action:"nouveau",affichageTable:!0}),X("tableau des relances")}}))}}}]);