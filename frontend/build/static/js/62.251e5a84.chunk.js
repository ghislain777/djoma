(this["webpackJsonpmatx-react-pro"]=this["webpackJsonpmatx-react-pro"]||[]).push([[62],{2328:function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return l})),a.d(t,"c",(function(){return d})),a.d(t,"d",(function(){return p}));var r=a(8),n=a.n(r),s=a(19),i=a(17);function o(e,t,a,r){return c.apply(this,arguments)}function c(){return(c=Object(s.a)(n.a.mark((function e(t,a,r,s){var o;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t+=1,e.next=3,i.b.get("/caisses?itemsPerPage="+a+"&page="+t+"&id="+r);case 3:return o=e.sent,e.abrupt("return",o.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function l(e){return u.apply(this,arguments)}function u(){return(u=Object(s.a)(n.a.mark((function e(t){var a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.b.post("/caisses",t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){return m.apply(this,arguments)}function m(){return(m=Object(s.a)(n.a.mark((function e(t){var a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.b.put("/caisses/"+t.id,t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return b.apply(this,arguments)}function b(){return(b=Object(s.a)(n.a.mark((function e(t){var a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.b.delete("/caisses/"+t.id,{method:"DELETE",herdears:{Accept:"application/json"},data:t.id});case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},3182:function(e,t,a){"use strict";a.r(t);var r=a(6),n=a(12),s=a(26),i=a(0),o=a.n(i),c=a(229),l=a.n(c),u=a(231),d=a(224),m=a(606),p=a(64),b=a(1241),g=a(1201),v=(a(95),a(79)),f=a(228),h=a(46),j=a(1204),E=a(1203),O=a(1202),y=a(144),C=a(783),w=a(2328),S=a(73),x=a(84),P=a(32),k=a(117),Q=a(131),D=(a(368),a(369),a(60)),R=(a(265),a(444),a(17)),I=a(1196),L=(a(367),a(150));const M=v.b().shape({utilisateur:v.c().required("Le champs utilisateur est requis"),solde:v.a().required("Solde requis").positive("Le Solde doit \xeatre positif").integer("Le Solde doit \xeatre un nombre entier")});function N({id:e,lecaisse:t,handleFermeture:a,action:s}){var c,l,u;const b=Object(P.useQueryClient)(),v=Object(P.useMutation)(w.a,{onSuccess:()=>{b.invalidateQueries("Caisses"),W({message:"Enregistrement r\xe9ussi",open:!0,severity:"success",automaticClose:!0})},onError:()=>{b.invalidateQueries("Caisses"),W({message:"Echec lors de l op\xe9ration",open:!0,severity:"error",automaticClose:!0})}}),N=Object(P.useMutation)(w.c,{onSuccess:()=>{b.invalidateQueries("Caisses"),W({message:"Mise \xe0 jour r\xe9ussie",open:!0,severity:"success",automaticClose:!0})},onError:()=>{b.invalidateQueries("Caisses"),W({message:"Echec lors de la mise \xe0 jour",open:!0,severity:"error",automaticClose:!0})}}),A=Object(P.useQuery)(["Utilisateurs",1],()=>Object(L.b)(0,100,"",""),{keepPreviousData:!0}),B=Object(i.useState)(t),F=Object(n.a)(B,2),T=F[0],q=(F[1],Object(i.useState)({severity:"severity",message:"",open:!1,automaticClose:!0})),z=Object(n.a)(q,2),J=z[0],W=z[1],G=Object(S.c)({resolver:Object(f.yupResolver)(M),defaultValues:Object(r.a)(Object(r.a)({},t),{},{id:null!==(c=null===t||void 0===t?void 0:t.id)&&void 0!==c?c:"",utilisateur:t?"/api/utilisateurs/"+t.utilisateur.id:"/api/utilisateurs/1",description:null!==(l=null===t||void 0===t?void 0:t.description)&&void 0!==l?l:""})}),U=G.control,V=G.handleSubmit,Y=G.errors,H=(G.reset,e=>{let t=Object(r.a)(Object(r.a)({},T),e);T?N.mutate(Object(r.a)({},t)):v.mutate(Object(r.a)({},t))});function K(){a()}return o.a.createElement("div",null,o.a.createElement(x.a,{message:J.message,severity:J.severity,open:J.open,handleAlertClose:J.automaticClose?a:()=>W(Object(r.a)(Object(r.a)({},J),{},{open:!1}))}),o.a.createElement(h.a,{container:!0,spacing:1,justify:"center"},o.a.createElement(h.a,{item:!0,lg:6,md:6,sm:12,xs:12,justify:"center"},o.a.createElement(I.a,{theme:Object(R.a)()},o.a.createElement(g.a,null,o.a.createElement(j.a,{action:o.a.createElement(d.a,{"aria-label":"",onClick:K},"x"),title:"ajout"===s?"Nouvelle caisse":"Mise \xe0 jour de caisse",subheader:""}),o.a.createElement(E.a,{className:" px-6 pt-6 pb-6"}," ",o.a.createElement("form",{onSubmit:V(H)},o.a.createElement(h.a,{container:!0,spacing:4,direction:"column"},o.a.createElement(h.a,{item:!0},A.isLoading?o.a.createElement(D.a,{message:"chargement des utilisateurs"}):o.a.createElement(Q.a,{id:"utilisateur",name:"utilisateur",label:"gestionnaire de la caisse",table:"utilisateur",control:U,options:A.data["hydra:member"],error:Y.utilisateur,valeur:null!==(u=null===T||void 0===T?void 0:T.utilisateur)&&void 0!==u?u:""})),o.a.createElement(h.a,{item:!0},o.a.createElement(k.a,{id:"solde",nom:"solde",label:"Solde",valeur:null===T||void 0===T?void 0:T.solde,control:U,error:Y.solde,disabled:!0})),o.a.createElement(h.a,{item:!0},o.a.createElement(k.a,{id:"description",nom:"description",label:"Description",valeur:null===T||void 0===T?void 0:T.description,control:U,error:Y.description,multiline:!0,rows:4}))))),o.a.createElement(O.a,null,o.a.createElement(h.a,{container:!0,alignItems:"center",justify:"space-between"},o.a.createElement(h.a,{item:!0},o.a.createElement(y.a,{color:"primary",variant:"contained",type:"submit",onClick:V(H)},N.isLoading||v.isLoading?o.a.createElement(C.a,{color:"inherit"}):o.a.createElement(m.a,null,"send"),o.a.createElement("span",{className:"pl-2 capitalize"},"ajout"===s?o.a.createElement(p.a,null,"Enregistrer"):o.a.createElement(p.a,null,"Mettre \xe0 jour")))),o.a.createElement(h.a,{item:!0},o.a.createElement(y.a,{variant:"outlined",color:"secondary",onClick:K},"Annuler")))))))))}var A=a(204),B=a(230),F=a(300),T=(a(443),a(3),a(110));Object(T.a)(e=>{e.palette,Object(s.a)(e,["palette"]);return{userMenu:{display:"flex",alignItems:"center",cursor:"pointer",borderRadius:24,padding:4,"& span":{margin:"0 8px"}},menuItem:{display:"flex",alignItems:"center",minWidth:185},userMenu:{display:"flex",alignItems:"center",cursor:"pointer",borderRadius:24,padding:4,"& span":{margin:"0 8px"}},menuItem:{display:"flex",alignItems:"center",minWidth:185}}});t.default=()=>{const e=Object(i.useState)({page:0,rowsPerPage:20,recherche:"",filtre:""}),t=Object(n.a)(e,2),a=t[0],s=t[1],c=Object(P.useQueryClient)(),v=Object(P.useQuery)(["Caisses",a.page,a.rowsPerPage,a.recherche,a.filtre],()=>Object(w.b)(a.page,a.rowsPerPage,a.recherche,a.filtre),{keepPreviousData:!0}),f=v.isLoading,h=(v.isFetching,v.isError),j=v.error,E=v.data,O=Object(P.useMutation)(w.d,{onSuccess:()=>{W({message:"Suppr\xe9ssion r\xe9ussi",open:!0,severity:"success"})},onError:()=>{W({message:"Echec lors de l op\xe9ration",open:!0,severity:"error"})},onSettled:()=>{c.invalidateQueries("Caisses")}}),y=Object(i.useState)(null),C=Object(n.a)(y,2),S=C[0],k=C[1],Q=Object(i.useState)({mode:"affichage",action:"ajout",affichageTable:!0}),L=Object(n.a)(Q,2),M=L[0],T=L[1],q=Object(i.useState)({severity:"severity",message:"",open:!1,handleCloseAlert:()=>$()}),z=Object(n.a)(q,2),J=z[0],W=z[1],G=Object(i.useState)("Caisse"),U=Object(n.a)(G,2),V=U[0],Y=U[1],H=Object(i.useState)(!1),K=Object(n.a)(H,2),X=K[0],Z=K[1],$=()=>{W(Object(r.a)(Object(r.a)({},x.a),{},{open:!1}))},_=[{name:"id",label:"ID",options:{filter:!1,sort:!1,display:"excluded",customBodyRender:(e,t,a)=>e}},{name:"utilisateur",label:"Gestionnaire de la caisse",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>e.nom}},{name:"solde",label:"Solde",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>e.toLocaleString("fr-FR")}},{name:"description",label:"Description",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>e}},{name:"action",label:"Actions",options:{filter:!1,sort:!1,customBodyRender:(e,t,a)=>o.a.createElement("div",null,o.a.createElement(d.a,{size:"small",onClick:()=>{(e=>{T({mode:"edition",action:"misajour",affichageTable:!1}),k(e),Y("Mise \xe0 jour de caisse")})({id:t.rowData[0],utilisateur:t.rowData[1],solde:t.rowData[2],description:t.rowData[3]})}},o.a.createElement(m.a,{color:"primary"},"edit")))}}];return o.a.createElement("div",{className:"m-sm-30"},o.a.createElement(x.a,{message:J.message,severity:J.severity,open:J.open,handleAlertClose:$}),o.a.createElement("div",{className:"mb-sm-30"},o.a.createElement(A.a,{routeSegments:[{name:"Solde de caisse"}]})),o.a.createElement("div",{className:"mb-sm-30"},o.a.createElement(p.a,{variant:"h4"},V)),"affichage"===M.mode?o.a.createElement(b.a,{in:M.affichageTable,direction:"right",unmountOnExit:!0},o.a.createElement("div",null,f?o.a.createElement(D.a,{message:"Chargement des donn\xe9es",type:"info"}):h?o.a.createElement(D.a,{message:"Erreur lors du chargement des donn\xe9es::"+j,type:"error"}):o.a.createElement(F.a,{tag:"div",blocking:!1},o.a.createElement(I.a,{theme:Object(R.a)()},o.a.createElement(l.a,{title:V,data:E["hydra:member"],columns:_,options:Object(r.a)(Object(r.a)({},u.a),{},{serverSide:!0,count:E["hydra:totalItems"],rowsPerPageOptions:[20,30,50],rowsPerPage:a.rowsPerPage,onChangePage:e=>(e=>{s(Object(r.a)(Object(r.a)({},a),{},{page:e})),c.invalidateQueries("Caisses")})(e),onChangeRowsPerPage:e=>(e=>{s(Object(r.a)(Object(r.a)({},a),{},{rowsPerPage:e})),console.log("idbre de ligne par page:"+e),c.invalidateQueries("Caisses")})(e),onSearchChange:e=>(e=>{var t;s(Object(r.a)(Object(r.a)({},a),{},{recherche:null!==e&&void 0!==e?e:""})),console.log(null!==(t="texte a chercher"+e)&&void 0!==t?t:""),c.invalidateQueries("Caisses")})(e),onFilterChange:()=>{console.log("le filtre a chang\xe9")}})}))),o.a.createElement(g.a,{className:"w-full overflow-auto",elevation:8},o.a.createElement(B.a,{open:X,onConfirmDialogClose:()=>{Z(!1)},onYesClick:()=>{Z(!1),O.mutate(S)},text:"Confirmez la suppression de "+(null===S||void 0===S?void 0:S.name)})))):o.a.createElement(N,{action:M.action,lecaisse:S,handleFermeture:()=>{T({mode:"affichage",action:"nouveau",affichageTable:!0}),Y("Caisse")}}))}}}]);