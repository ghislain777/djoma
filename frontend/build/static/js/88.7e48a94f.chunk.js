(this["webpackJsonpmatx-react-pro"]=this["webpackJsonpmatx-react-pro"]||[]).push([[88],{3125:function(e,t,a){"use strict";a.r(t);var c=a(6),n=a(12),l=a(0),r=a.n(l),s=a(2179),m=a(1201),i=a(95),o=a(44),d=a.n(o);const u=e=>d.a.get("/api/chat/contacts",{data:e}),p=e=>d.a.post("/api/chat/add",e);var h=a(26),E=a(789),b=a.n(E),v=a(2241),g=a(1192),f=a(110),j=a(3);const x=Object(f.a)(e=>{e.palette,Object(h.a)(e,["palette"]);return{chatSidenav:{borderRight:"1px solid rgba(0, 0, 0, 0.08)",height:450}}});var N=({currentUser:e,contactList:t=[],recentContactList:a=[],handleContactClick:c})=>{const n=x();return r.a.createElement("div",{className:Object(j.default)("bg-default",n.chatSidenav)},r.a.createElement("div",{className:"chat-sidenav__topbar flex items-center h-56 px-4 bg-primary"},r.a.createElement(i.c,{src:e.avatar,status:e.status}),r.a.createElement("h5",{className:"ml-4 whitespace-pre mb-0 font-medium text-18 text-white"},e.name)),r.a.createElement(b.a,{className:"relative h-full"},a.map((e,t)=>r.a.createElement("div",{onClick:()=>c(e.id),key:t,className:"flex items-center p-4 cursor-pointer  gray-on-hover"},r.a.createElement(i.c,{src:e.avatar,status:e.status}),r.a.createElement("div",{className:"pl-4"},r.a.createElement("p",{className:"m-0"},e.name),r.a.createElement("p",{className:"m-0 text-muted"},Object(g.a)(new Date(e.lastChatTime).getTime(),"MMMM dd, yyyy"))))),r.a.createElement(v.a,null),t.map((e,t)=>r.a.createElement("div",{onClick:()=>c(e.id),key:t,className:"flex items-center px-4 py-1 cursor-pointer  gray-on-hover"},r.a.createElement(i.c,{src:e.avatar,status:e.status}),r.a.createElement("div",{className:"pl-4"},r.a.createElement("p",null,e.name))))))},O=a(2201),y=a(224),w=a(606),C=a(568),S=a(426),k=a(2272);const I=Object(f.a)(e=>{e.palette,Object(h.a)(e,["palette"]);return{icon:{fontSize:"4rem"}}});var L=()=>{const e=I();return r.a.createElement("div",{className:"h-220 w-220 rounded elevation-z6 bg-default flex justify-center items-center"},r.a.createElement(w.a,{className:e.icon,color:"primary"},"chat"))},U=a(269),_=a(33),M=a.n(_);const D=Object(f.a)(e=>{e.palette,Object(h.a)(e,["palette"]);return{chatContainer:{background:"rgba(0, 0, 0, 0.05)",height:450}}});var T=({id:e,toggleSidenav:t,currentChatRoom:a,opponentUser:c,messageList:s=[],handleMessageSend:m})=>{const o=Object(l.useState)(""),d=Object(n.a)(o,2),u=d[0],p=d[1],h=D();return r.a.createElement("div",{className:Object(j.default)("flex-column relative",h.chatContainer)},r.a.createElement("div",{className:"chat-container__topbar flex items-center justify-between p-1 bg-primary"},r.a.createElement("div",{className:"flex items-center"},r.a.createElement(O.a,{mdUp:!0},r.a.createElement(y.a,{onClick:t},r.a.createElement(w.a,{className:"text-white"},"short_text"))),r.a.createElement(O.a,{smDown:!0},r.a.createElement("div",{className:"pl-3"})),c&&r.a.createElement(l.Fragment,null,r.a.createElement(i.c,{src:c.avatar,status:c.status}),r.a.createElement("h5",{className:"ml-4 whitespace-pre mb-0 font-medium text-18 text-white"},c.name))),r.a.createElement(i.p,{menuButton:r.a.createElement(y.a,null,r.a.createElement(w.a,{className:"text-white"},"more_vert"))},r.a.createElement(C.a,{className:"flex items-center"},r.a.createElement(w.a,{className:"mr-4"},"account_circle")," Contact"),r.a.createElement(C.a,{className:"flex items-center"},r.a.createElement(w.a,{className:"mr-4"},"volume_mute")," Mute"),r.a.createElement(C.a,{className:"flex items-center"},r.a.createElement(w.a,{className:"mr-4"},"delete")," Clear Chat"))),r.a.createElement(b.a,{className:"chat-message-list flex-grow relative",id:"chat-message-list"},""===a&&r.a.createElement("div",{className:"flex-column justify-center items-center h-full"},r.a.createElement(L,null),r.a.createElement("p",null,"Select a contact")),s.map((t,a)=>r.a.createElement("div",{className:"flex items-start px-4 py-3",key:M.a.generate()},r.a.createElement(i.c,{src:t.avatar,status:t.status}),r.a.createElement("div",{className:"ml-4"},r.a.createElement("p",{className:"text-muted m-0 mb-2"},t.name),r.a.createElement("div",{className:Object(j.default)({"px-4 py-2 mb-2 border-radius-4 bg-paper":!0,"bg-primary text-white":e===t.contactId})},r.a.createElement("span",{className:"whitespace-pre-wrap"},t.text)),r.a.createElement("small",{className:"text-muted mb-0"},Object(U.d)(new Date(t.time))," ago"))))),r.a.createElement(v.a,null),""!==a&&r.a.createElement("div",{className:"flex items-center px-4 py-2"},r.a.createElement(S.a,{label:"Type your message here*",value:u,onChange:e=>p(e.target.value),onKeyUp:e=>{if("Enter"===e.key&&!e.shiftKey){let e=u.trim();""!==e&&m(e),p("")}},fullWidth:!0,multiline:!0,rows:1,variant:"outlined"}),r.a.createElement("div",null,r.a.createElement(k.a,{onClick:()=>{""!==u.trim()&&m(u),p("")},color:"primary",className:"ml-4"},r.a.createElement(w.a,null,"send")))))},R=a(41);t.default=()=>{const e=document.querySelector("#chat-message-list"),t=Object(l.useState)(!0),a=Object(n.a)(t,2),o=a[0],h=a[1],E=Object(l.useState)({id:"7863a6802ez0e277a0f98534"}),b=Object(n.a)(E,2),v=b[0],g=b[1],f=Object(l.useState)(null),j=Object(n.a)(f,2),x=j[0],O=j[1],y=Object(l.useState)(""),w=Object(n.a)(y,2),C=w[0],S=w[1],k=Object(l.useState)([]),I=Object(n.a)(k,2),L=I[0],U=I[1],_=Object(l.useState)([]),M=Object(n.a)(_,2),D=M[0],z=M[1],H=Object(l.useState)([]),J=Object(n.a)(H,2),K=J[0],q=J[1],B=Object(l.useRef)(v),F=Object(R.a)(),W=Object(s.a)(F.breakpoints.down("sm")),Y=Object(l.useCallback)(()=>{(e=>d.a.get("/api/chat/contacts/recent",{data:e}))(B.current.id).then(e=>{z(e.data)})},[]);Object(l.useEffect)(()=>{let e=B.current.id;var t;u(e).then(e=>{h(W),g(Object(c.a)({},e.data))}),(t=v.id,d.a.get("/api/chat/contacts/all",{data:t})).then(e=>U(e.data)),Y()},[W,v.id,Y]);const A=()=>{e&&e.scrollTo({top:e.scrollHeight,behavior:"smooth"})},G=()=>{h(!o)};return r.a.createElement("div",{className:"m-sm-30"},r.a.createElement("div",{className:"mb-sm-30"},r.a.createElement(i.b,{routeSegments:[{name:"Chat"}]})),r.a.createElement(m.a,{elevation:6},r.a.createElement(i.t,null,r.a.createElement(i.s,{width:"230px",open:o,toggleSidenav:G},r.a.createElement(N,{currentUser:v,contactList:L,recentContactList:D,handleContactClick:e=>{W&&G(),u(e).then(({data:e})=>{O(Object(c.a)({},e))}),((e,t)=>d.a.get("/api/chat/chat-room",{data:{currentUser:e,contactId:t}}))(v.id,e).then(({data:e})=>{let t=e.chatId,a=e.messageList,c=e.recentListUpdated;S(t),q(a),A(),c&&Y()})}})),r.a.createElement(i.u,null,r.a.createElement(T,{id:null===v||void 0===v?void 0:v.id,opponentUser:x,messageList:K,currentChatRoom:C,handleMessageSend:e=>{let t=v.id;""!==C&&(p({chatId:C,text:e,contactId:t,time:new Date}).then(e=>{q([...e.data]),A()}),setTimeout(()=>{p({chatId:C,text:"Hi, I'm ".concat(x.name,". Your imaginary friend."),contactId:x.id,time:new Date}).then(e=>{q([...e.data]),A()})},750))},toggleSidenav:G})))))}}}]);