(this["webpackJsonpmatx-react-pro"]=this["webpackJsonpmatx-react-pro"]||[]).push([[99],{3185:function(e,a,t){"use strict";t.r(a);var r=t(6),n=t(12),s=t(26),o=t(0),i=t.n(o),l=t(229),c=t.n(l),m=t(231),u=t(224),d=t(606),p=t(64),b=t(1241),v=t(144),g=t(1201),h=(t(95),t(79)),E=t(228),j=t(46),O=t(1204),f=t(1203),y=t(1202),C=t(783),S=t(834),w=t(73),P=t(84),x=t(32),N=t(117),k=(t(131),t(368),t(369),t(60)),Q=(t(265),t(444),t(17)),D=t(1196);t(367);const I=h.b().shape({nom:h.c().required("Le champs Nom est requis"),telephone:h.c().required("Le champs T\xe9l\xe9phone est requis"),adresse:h.c().required("Le champs Adresse est requis")});function M({id:e,lesoustraitant:a,handleFermeture:t,action:s}){var l,c,m,b;const h=Object(x.useQueryClient)(),k=Object(x.useMutation)(S.a,{onSuccess:()=>{h.invalidateQueries("Soustraitants"),B({message:"Enregistrement r\xe9ussi",open:!0,severity:"success",automaticClose:!0})},onError:()=>{h.invalidateQueries("Soustraitants"),B({message:"Echec lors de l op\xe9ration",open:!0,severity:"error",automaticClose:!0})}}),M=Object(x.useMutation)(S.c,{onSuccess:()=>{h.invalidateQueries("Soustraitants"),B({message:"Mise \xe0 jour r\xe9ussie",open:!0,severity:"success",automaticClose:!0})},onError:()=>{h.invalidateQueries("Soustraitants"),B({message:"Echec lors de la mise \xe0 jour",open:!0,severity:"error",automaticClose:!0})}}),R=Object(o.useState)(a),A=Object(n.a)(R,2),L=A[0],T=(A[1],Object(o.useState)({severity:"severity",message:"",open:!1,automaticClose:!0})),q=Object(n.a)(T,2),z=q[0],B=q[1],F=Object(w.c)({resolver:Object(E.yupResolver)(I),defaultValues:Object(r.a)(Object(r.a)({},a),{},{id:null!==(l=null===a||void 0===a?void 0:a.id)&&void 0!==l?l:"",nom:null!==(c=null===a||void 0===a?void 0:a.nom)&&void 0!==c?c:"",telephone:null!==(m=null===a||void 0===a?void 0:a.telephone)&&void 0!==m?m:"",adresse:null!==(b=null===a||void 0===a?void 0:a.adresse)&&void 0!==b?b:""})}),J=F.control,W=F.handleSubmit,_=F.errors,G=(F.reset,e=>{let a=Object(r.a)(Object(r.a)({},L),e);L?M.mutate(Object(r.a)({},a)):k.mutate(Object(r.a)({},a))});function V(){t()}return i.a.createElement("div",null,i.a.createElement(P.a,{message:z.message,severity:z.severity,open:z.open,handleAlertClose:z.automaticClose?t:()=>B(Object(r.a)(Object(r.a)({},z),{},{open:!1}))}),i.a.createElement(j.a,{container:!0,spacing:1,justify:"center"},i.a.createElement(j.a,{item:!0,lg:6,md:6,sm:12,xs:12,justify:"center"},i.a.createElement(D.a,{theme:Object(Q.a)()},i.a.createElement(g.a,null,i.a.createElement(O.a,{action:i.a.createElement(u.a,{"aria-label":"",onClick:V},"x"),title:"ajout"===s?"Nouveau sous-traitant":"Mise \xe0 jour de soustraitant",subheader:""}),i.a.createElement(f.a,{className:" px-6 pt-6 pb-6"}," ",i.a.createElement("form",{onSubmit:W(G)},i.a.createElement(j.a,{container:!0,spacing:4,direction:"column"},i.a.createElement(j.a,{item:!0},i.a.createElement(N.a,{id:"nom",nom:"nom",label:"Nom",valeur:null===L||void 0===L?void 0:L.nom,control:J,error:_.nom})),i.a.createElement(j.a,{item:!0},i.a.createElement(N.a,{id:"telephone",nom:"telephone",label:"T\xe9l\xe9phone",valeur:null===L||void 0===L?void 0:L.telephone,control:J,error:_.telephone})),i.a.createElement(j.a,{item:!0},i.a.createElement(N.a,{id:"adresse",nom:"adresse",label:"Adresse",valeur:null===L||void 0===L?void 0:L.adresse,control:J,error:_.adresse}))))),i.a.createElement(y.a,null,i.a.createElement(j.a,{container:!0,alignItems:"center",justify:"space-between"},i.a.createElement(j.a,{item:!0},i.a.createElement(v.a,{color:"primary",variant:"contained",type:"submit",onClick:W(G)},M.isLoading||k.isLoading?i.a.createElement(C.a,{color:"inherit"}):i.a.createElement(d.a,null,"send"),i.a.createElement("span",{className:"pl-2 capitalize"},"ajout"===s?i.a.createElement(p.a,null,"Enregistrer"):i.a.createElement(p.a,null,"Mettre \xe0 jour")))),i.a.createElement(j.a,{item:!0},i.a.createElement(v.a,{variant:"outlined",color:"secondary",onClick:V},"Annuler")))))))))}var R=t(204),A=t(230),L=t(300),T=(t(443),t(3),t(110));Object(T.a)(e=>{e.palette,Object(s.a)(e,["palette"]);return{userMenu:{display:"flex",alignItems:"center",cursor:"pointer",borderRadius:24,padding:4,"& span":{margin:"0 8px"}},menuItem:{display:"flex",alignItems:"center",minWidth:185},userMenu:{display:"flex",alignItems:"center",cursor:"pointer",borderRadius:24,padding:4,"& span":{margin:"0 8px"}},menuItem:{display:"flex",alignItems:"center",minWidth:185}}});a.default=()=>{const e=Object(o.useState)({page:0,rowsPerPage:20,recherche:"",filtre:""}),a=Object(n.a)(e,2),t=a[0],s=a[1],l=Object(x.useQueryClient)(),h=Object(x.useQuery)(["Soustraitants",t.page,t.rowsPerPage,t.recherche,t.filtre],()=>Object(S.b)(t.page,t.rowsPerPage,t.recherche,t.filtre),{keepPreviousData:!0}),E=h.isLoading,j=(h.isFetching,h.isError),O=h.error,f=h.data,y=Object(x.useMutation)(S.d,{onSuccess:()=>{_({message:"Suppr\xe9ssion r\xe9ussi",open:!0,severity:"success"})},onError:()=>{_({message:"Echec lors de l op\xe9ration",open:!0,severity:"error"})},onSettled:()=>{l.invalidateQueries("Soustraitants")}}),C=Object(o.useState)(null),w=Object(n.a)(C,2),N=w[0],I=w[1],T=Object(o.useState)({mode:"affichage",action:"ajout",affichageTable:!0}),q=Object(n.a)(T,2),z=q[0],B=q[1],F=Object(o.useState)({severity:"severity",message:"",open:!1,handleCloseAlert:()=>$()}),J=Object(n.a)(F,2),W=J[0],_=J[1],G=Object(o.useState)("Liste des soustraitants"),V=Object(n.a)(G,2),Y=V[0],H=V[1],K=Object(o.useState)(!1),U=Object(n.a)(K,2),X=U[0],Z=U[1],$=()=>{_(Object(r.a)(Object(r.a)({},P.a),{},{open:!1}))},ee=[{name:"id",label:"ID",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>e}},{name:"nom",label:"Nom",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>e}},{name:"telephone",label:"T\xe9l\xe9phone",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>e}},{name:"adresse",label:"Adresse",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>e}},{name:"action",label:"Actions",options:{filter:!1,sort:!1,customBodyRender:(e,a,t)=>i.a.createElement("div",null,i.a.createElement(u.a,{size:"small",onClick:()=>{(e=>{B({mode:"edition",action:"misajour",affichageTable:!1}),I(e),H("Mise \xe0 jour de soustraitant")})({id:a.rowData[0],nom:a.rowData[1],telephone:a.rowData[2],adresse:a.rowData[3]})}},i.a.createElement(d.a,{color:"primary"},"edit")),i.a.createElement(u.a,{size:"small",onClick:()=>(e=>{Z(!0),I(e)})({id:a.rowData[0]})},i.a.createElement(d.a,{color:"error"},"delete")),i.a.createElement(u.a,{size:"small",onClick:()=>(a.rowData[0],void console.log("affichage de details"))},i.a.createElement(d.a,null,"arrow_right_alt")))}}];return i.a.createElement("div",{className:"m-sm-30"},i.a.createElement(P.a,{message:W.message,severity:W.severity,open:W.open,handleAlertClose:$}),i.a.createElement("div",{className:"mb-sm-30"},i.a.createElement(R.a,{routeSegments:[{name:"Gestion des sous-traitants"}]})),i.a.createElement("div",{className:"mb-sm-30"},i.a.createElement(p.a,{variant:"h4"},Y)),"affichage"===z.mode?i.a.createElement(b.a,{in:z.affichageTable,direction:"right",unmountOnExit:!0},i.a.createElement("div",null,i.a.createElement(v.a,{className:"mb-4",variant:"contained",color:"primary",onClick:()=>(B({mode:"edition",action:"ajout",affichageTable:!1}),I(null),void H("Nouveau sous-traitant"))},"Nouveau sous-traitant"),E?i.a.createElement(k.a,{message:"Chargement des donn\xe9es",type:"info"}):j?i.a.createElement(k.a,{message:"Erreur lors du chargement des donn\xe9es::"+O,type:"error"}):i.a.createElement(L.a,{tag:"div",blocking:!1},i.a.createElement(D.a,{theme:Object(Q.a)()},i.a.createElement(c.a,{title:Y,data:f["hydra:member"],columns:ee,options:Object(r.a)(Object(r.a)({},m.a),{},{serverSide:!0,count:f["hydra:totalItems"],rowsPerPageOptions:[20,30,50],rowsPerPage:t.rowsPerPage,onChangePage:e=>(e=>{s(Object(r.a)(Object(r.a)({},t),{},{page:e})),l.invalidateQueries("Soustraitants")})(e),onChangeRowsPerPage:e=>(e=>{s(Object(r.a)(Object(r.a)({},t),{},{rowsPerPage:e})),console.log("idbre de ligne par page:"+e),l.invalidateQueries("Soustraitants")})(e),onSearchChange:e=>(e=>{var a;s(Object(r.a)(Object(r.a)({},t),{},{recherche:null!==e&&void 0!==e?e:""})),console.log(null!==(a="texte a chercher"+e)&&void 0!==a?a:""),l.invalidateQueries("Soustraitants")})(e),onFilterChange:()=>{console.log("le filtre a chang\xe9")}})}))),i.a.createElement(g.a,{className:"w-full overflow-auto",elevation:8},i.a.createElement(A.a,{open:X,onConfirmDialogClose:()=>{Z(!1)},onYesClick:()=>{Z(!1),y.mutate(N)},text:"Confirmez la suppression de "+(null===N||void 0===N?void 0:N.name)})))):i.a.createElement(M,{action:z.action,lesoustraitant:N,handleFermeture:()=>{B({mode:"affichage",action:"nouveau",affichageTable:!0}),H("Liste des soustraitants")}}))}}}]);