(this["webpackJsonpmatx-react-pro"]=this["webpackJsonpmatx-react-pro"]||[]).push([[54],{2400:function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return l})),a.d(t,"c",(function(){return m})),a.d(t,"d",(function(){return d}));var r=a(8),n=a.n(r),i=a(19),s=a(17);function c(e,t,a,r){return o.apply(this,arguments)}function o(){return(o=Object(i.a)(n.a.mark((function e(t,a,r,i){var c;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t+=1,e.next=3,s.b.get("/menus?itemsPerPage="+a+"&page="+t+"&nom="+r);case 3:return c=e.sent,e.abrupt("return",c.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function l(e){return u.apply(this,arguments)}function u(){return(u=Object(i.a)(n.a.mark((function e(t){var a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.b.post("/menus",t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return p.apply(this,arguments)}function p(){return(p=Object(i.a)(n.a.mark((function e(t){var a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.b.put("/menus/"+t.id,t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){return v.apply(this,arguments)}function v(){return(v=Object(i.a)(n.a.mark((function e(t){var a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.b.delete("/menus/"+t.id,{method:"DELETE",herdears:{Accept:"application/json"},data:t.id});case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},3157:function(e,t,a){"use strict";a.r(t);var r=a(6),n=a(12),i=a(0),s=a.n(i),c=a(229),o=a.n(c),l=a(231),u=a(224),m=a(606),p=a(64),d=a(1241),v=a(144),b=a(1201),h=a(46),f=a(79),g=a(228),E=a(783),j=a(8),y=a.n(j),O=a(19),w=a(17);function C(){return(C=Object(O.a)(y.a.mark((function e(t,a,r,n){var i;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t+=1,e.next=3,w.b.get("/activites?itemsPerPage="+a+"&page="+t+"&nom="+r);case 3:return i=e.sent,e.abrupt("return",i.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e){return P.apply(this,arguments)}function P(){return(P=Object(O.a)(y.a.mark((function e(t){var a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.b.post("/activites",t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e){return S.apply(this,arguments)}function S(){return(S=Object(O.a)(y.a.mark((function e(t){var a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.b.put("/activites/"+t.id,t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e){return A.apply(this,arguments)}function A(){return(A=Object(O.a)(y.a.mark((function e(t){var a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.b.delete("/activites/"+t.id,{method:"DELETE",herdears:{Accept:"application/json"},data:t.id});case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var L=a(73),N=a(84),Q=a(32),M=a(117),R=a(131),q=(a(368),a(369),a(367),a(2400)),B=a(60);const T=f.b().shape({nom:f.c().required("Le champs Nom est requis"),description:f.c().required("Le champs Description est requis"),chemain:f.c().required("Le champs Chemain est requis"),menu:f.c().required("Le champs Menu est requis")});function z({id:e,leactivite:t,handleFermeture:a,action:c}){var o;const l=Object(Q.useQueryClient)(),u=Object(Q.useMutation)(x,{onSuccess:()=>{l.invalidateQueries("Activites"),D({message:"Enregistrement r\xe9ussi",open:!0,severity:"success",automaticClose:!0})},onError:()=>{l.invalidateQueries("Activites"),D({message:"Echec lors de l op\xe9ration",open:!0,severity:"error",automaticClose:!0})}}),d=Object(Q.useMutation)(k,{onSuccess:()=>{l.invalidateQueries("Activites"),D({message:"Mise \xe0 jour r\xe9ussie",open:!0,severity:"success",automaticClose:!0})},onError:()=>{l.invalidateQueries("Activites"),D({message:"Echec lors de la mise \xe0 jour",open:!0,severity:"error",automaticClose:!0})}}),b=Object(Q.useQuery)(["Menus",1],()=>Object(q.b)(0,100,"",""),{keepPreviousData:!0}),f=b.isLoading,j=(b.isFetching,b.isError,b.error,b.data),y=Object(i.useState)(t),O=Object(n.a)(y,2),w=O[0],C=(O[1],Object(i.useState)({severity:"severity",message:"",open:!1,automaticClose:!0})),P=Object(n.a)(C,2),S=P[0],D=P[1],A=Object(L.c)({resolver:Object(g.yupResolver)(T),defaultValues:{menu:t?"/api/menus/"+t.menu.id:"/api/menus/1"}}),z=A.control,F=A.handleSubmit,I=A.errors,J=(A.reset,e=>{let t=Object(r.a)(Object(r.a)({},w),e);w?d.mutate(Object(r.a)({},t)):u.mutate(Object(r.a)({},t))});return s.a.createElement("div",null,s.a.createElement(N.a,{message:S.message,severity:S.severity,open:S.open,handleAlertClose:S.automaticClose?a:()=>D(Object(r.a)(Object(r.a)({},S),{},{open:!1}))}),s.a.createElement("form",{onSubmit:F(J)},s.a.createElement(h.a,{container:!0,spacing:4,direction:"column"},s.a.createElement(h.a,{item:!0},f?s.a.createElement(B.a,{message:"chargement"}):s.a.createElement(R.a,{id:"menu",name:"menu",label:"Choisir un menu",table:"menu",control:z,options:j["hydra:member"],error:I.menu,valeur:null!==(o=null===w||void 0===w?void 0:w.menu)&&void 0!==o?o:""})),s.a.createElement(h.a,{item:!0},s.a.createElement(M.a,{id:"nom",nom:"nom",label:"Nom",valeur:null===w||void 0===w?void 0:w.nom,control:z,error:I.nom})),s.a.createElement(h.a,{item:!0},s.a.createElement(M.a,{id:"description",nom:"description",label:"Description",valeur:null===w||void 0===w?void 0:w.description,control:z,error:I.description})),s.a.createElement(h.a,{item:!0},s.a.createElement(M.a,{id:"chemain",nom:"chemain",label:"Chemain",valeur:null===w||void 0===w?void 0:w.chemain,control:z,error:I.chemain})),s.a.createElement(h.a,{item:!0},s.a.createElement(h.a,{container:!0,alignItems:"center",justify:"space-between"},s.a.createElement(h.a,{item:!0},s.a.createElement(v.a,{color:"primary",variant:"contained",type:"submit",onClick:F(J)},d.isLoading||u.isLoading?s.a.createElement(E.a,{color:"inherit"}):s.a.createElement(m.a,null,"send"),s.a.createElement("span",{className:"pl-2 capitalize"},"ajout"===c?s.a.createElement(p.a,null,"Enregistrer"):s.a.createElement(p.a,null,"Mettre \xe0 jour")))),s.a.createElement(h.a,{item:!0},s.a.createElement(v.a,{variant:"outlined",color:"secondary",onClick:function(){a()}},"Annuler")))))))}var F=a(204),I=a(230),J=a(300);a(443);t.default=()=>{const e=Object(i.useState)({page:0,rowsPerPage:20,recherche:"",filtre:""}),t=Object(n.a)(e,2),a=t[0],c=t[1],f=Object(Q.useQueryClient)(),g=Object(Q.useQuery)(["Activites",a.page,a.rowsPerPage,a.recherche,a.filtre],()=>function(e,t,a,r){return C.apply(this,arguments)}(a.page,a.rowsPerPage,a.recherche,a.filtre),{keepPreviousData:!0}),E=g.isLoading,j=(g.isFetching,g.isError),y=g.error,O=g.data,w=Object(Q.useMutation)(D,{onSuccess:()=>{V({message:"Suppr\xe9ssion r\xe9ussi",open:!0,severity:"success"})},onError:()=>{V({message:"Echec lors de l op\xe9ration",open:!0,severity:"error"})},onSettled:()=>{f.invalidateQueries("Activites")}}),x=Object(i.useState)(null),P=Object(n.a)(x,2),k=P[0],S=P[1],A=Object(i.useState)({mode:"affichage",action:"ajout",affichageTable:!0}),L=Object(n.a)(A,2),M=L[0],R=L[1],q=Object(i.useState)({severity:"severity",message:"",open:!1,handleCloseAlert:()=>$()}),T=Object(n.a)(q,2),_=T[0],V=T[1],Y=Object(i.useState)("Liste des activites"),G=Object(n.a)(Y,2),H=G[0],K=G[1],U=Object(i.useState)(!1),W=Object(n.a)(U,2),X=W[0],Z=W[1],$=()=>{V(Object(r.a)(Object(r.a)({},N.a),{},{open:!1}))},ee=[{name:"id",label:"ID",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>e}},{name:"nom",label:"Nom",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>e}},{name:"description",label:"Description",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>e}},{name:"chemain",label:"Chemain",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>e}},{name:"icone",label:"Icone",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>e}},{name:"menu",label:"Menu",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>e.nom}},{name:"action",label:"Actions",options:{filter:!1,sort:!1,customBodyRender:(e,t,a)=>s.a.createElement("div",null,s.a.createElement(u.a,{size:"small",onClick:()=>{(e=>{R({mode:"edition",action:"misajour",affichageTable:!1}),S(e),K("Mise \xe0 jour de l'activit\xe9")})({id:t.rowData[0],nom:t.rowData[1],description:t.rowData[2],chemain:t.rowData[3],icone:t.rowData[4],menu:t.rowData[5]})}},s.a.createElement(m.a,{color:"primary"},"edit")),s.a.createElement(u.a,{size:"small",onClick:()=>(e=>{Z(!0),S(e)})({id:t.rowData[0]})},s.a.createElement(m.a,{color:"error"},"delete")),s.a.createElement(u.a,{size:"small",onClick:()=>(t.rowData[0],void console.log("affichage de details"))},s.a.createElement(m.a,null,"arrow_right_alt")))}}];return s.a.createElement("div",{className:"m-sm-30"},s.a.createElement(N.a,{message:_.message,severity:_.severity,open:_.open,handleAlertClose:$}),s.a.createElement("div",{className:"mb-sm-30"},s.a.createElement(F.a,{routeSegments:[{name:"Liste des activit\xe9s"}]})),s.a.createElement("div",{className:"mb-sm-30"},s.a.createElement(p.a,{variant:"h4"},H)),"affichage"===M.mode?s.a.createElement(d.a,{in:M.affichageTable,direction:"right",unmountOnExit:!0},s.a.createElement("div",null,s.a.createElement(v.a,{className:"mb-4",variant:"contained",color:"primary",onClick:()=>(R({mode:"edition",action:"ajout",affichageTable:!1}),S(null),void K("Nouvelle activit\xe9"))},"Nouvelle activit\xe9"),E?s.a.createElement(B.a,{message:"Chargement des donn\xe9es",type:"info"}):j?s.a.createElement(B.a,{message:"Erreur lors du chargement des donn\xe9es::"+y,type:"error"}):s.a.createElement(J.a,{tag:"div",blocking:!1},s.a.createElement(o.a,{title:H,data:O["hydra:member"],columns:ee,options:Object(r.a)(Object(r.a)({},l.a),{},{serverSide:!0,count:O["hydra:totalItems"],rowsPerPageOptions:[20,50,100],rowsPerPage:a.rowsPerPage,onChangePage:e=>(e=>{c(Object(r.a)(Object(r.a)({},a),{},{page:e})),f.invalidateQueries("Activites")})(e),onChangeRowsPerPage:e=>(e=>{c(Object(r.a)(Object(r.a)({},a),{},{rowsPerPage:e})),console.log("nombre de ligne par page:"+e),f.invalidateQueries("Activites")})(e),onSearchChange:e=>(e=>{var t;c(Object(r.a)(Object(r.a)({},a),{},{recherche:null!==e&&void 0!==e?e:""})),console.log(null!==(t="texte a chercher"+e)&&void 0!==t?t:""),f.invalidateQueries("Activites")})(e),onFilterChange:()=>{console.log("le filtre a chang\xe9")}})})),s.a.createElement(b.a,{className:"w-full overflow-auto",elevation:8},s.a.createElement(I.a,{open:X,onConfirmDialogClose:()=>{Z(!1)},onYesClick:()=>{Z(!1),w.mutate(k)},text:"Confirmez la suppression de "+(null===k||void 0===k?void 0:k.name)})))):s.a.createElement(h.a,{container:!0,spacing:6,alignContent:"center",justify:"center"},s.a.createElement(h.a,{item:!0,lg:6,md:6,sm:12,xs:12},s.a.createElement(b.a,{className:"px-6 pt-2 pb-4"},s.a.createElement(z,{action:M.action,leactivite:k,handleFermeture:()=>{R({mode:"affichage",action:"nouveau",affichageTable:!0}),K("Liste des activites")}})))))}}}]);