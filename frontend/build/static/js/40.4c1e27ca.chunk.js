(this["webpackJsonpmatx-react-pro"]=this["webpackJsonpmatx-react-pro"]||[]).push([[40],{2324:function(e,a,t){"use strict";t.d(a,"b",(function(){return i})),t.d(a,"a",(function(){return o})),t.d(a,"c",(function(){return p})),t.d(a,"d",(function(){return d}));var r=t(8),n=t.n(r),c=t(19),s=t(17);function i(e,a,t,r){return u.apply(this,arguments)}function u(){return(u=Object(c.a)(n.a.mark((function e(a,t,r,c){var i;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a+=1,e.next=3,s.b.get("/vehicules?itemsPerPage="+t+"&page="+a+"&marque="+r);case 3:return i=e.sent,e.abrupt("return",i.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function o(e){return l.apply(this,arguments)}function l(){return(l=Object(c.a)(n.a.mark((function e(a){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.b.post("/vehicules",a);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return m.apply(this,arguments)}function m(){return(m=Object(c.a)(n.a.mark((function e(a){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.b.put("/vehicules/"+a.id,a);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){return h.apply(this,arguments)}function h(){return(h=Object(c.a)(n.a.mark((function e(a){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.b.delete("/vehicules/"+a.id,{method:"DELETE",herdears:{Accept:"application/json"},data:a.id});case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},2353:function(e,a,t){"use strict";t.d(a,"c",(function(){return i})),t.d(a,"a",(function(){return o})),t.d(a,"d",(function(){return p})),t.d(a,"e",(function(){return d})),t.d(a,"f",(function(){return f})),t.d(a,"b",(function(){return b}));var r=t(8),n=t.n(r),c=t(19),s=t(17);function i(e,a,t,r){return u.apply(this,arguments)}function u(){return(u=Object(c.a)(n.a.mark((function e(a,t,r,c){var i;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a+=1,e.next=3,s.b.get("/chauffeurs?itemsPerPage="+t+"&page="+a+"&nom="+r);case 3:return i=e.sent,e.abrupt("return",i.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function o(e){return l.apply(this,arguments)}function l(){return(l=Object(c.a)(n.a.mark((function e(a){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.b.post("/chauffeurs",a);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return m.apply(this,arguments)}function m(){return(m=Object(c.a)(n.a.mark((function e(a){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.b.put("/chauffeurs/"+a.id,a);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){return h.apply(this,arguments)}function h(){return(h=Object(c.a)(n.a.mark((function e(a){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.b.delete("/chauffeurs/"+a.id,{method:"DELETE",herdears:{Accept:"application/json"},data:a.id});case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return v.apply(this,arguments)}function v(){return(v=Object(c.a)(n.a.mark((function e(a){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.b.put("/chauffeurs/statut/togle/"+a.id);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e){return y.apply(this,arguments)}function y(){return(y=Object(c.a)(n.a.mark((function e(a){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.b.get("/chauffeurs/sansvehicule");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},2401:function(e,a,t){"use strict";t.d(a,"b",(function(){return i})),t.d(a,"a",(function(){return o})),t.d(a,"c",(function(){return p})),t.d(a,"d",(function(){return d}));var r=t(8),n=t.n(r),c=t(19),s=t(17);function i(e,a,t,r){return u.apply(this,arguments)}function u(){return(u=Object(c.a)(n.a.mark((function e(a,t,r,c){var i;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a+=1,e.next=3,s.b.get("/partenaires?itemsPerPage="+t+"&page="+a+"&nom="+r);case 3:return i=e.sent,e.abrupt("return",i.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function o(e){return l.apply(this,arguments)}function l(){return(l=Object(c.a)(n.a.mark((function e(a){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.b.post("/partenaires",a);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return m.apply(this,arguments)}function m(){return(m=Object(c.a)(n.a.mark((function e(a){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.b.put("/partenaires/"+a.id,a);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){return h.apply(this,arguments)}function h(){return(h=Object(c.a)(n.a.mark((function e(a){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.b.delete("/partenaires/"+a.id,{method:"DELETE",herdears:{Accept:"application/json"},data:a.id});case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},3158:function(e,a,t){"use strict";t.r(a);var r=t(6),n=t(12),c=t(0),s=t.n(c),i=t(229),u=t.n(i),o=t(231),l=t(2302),p=t(224),m=t(606),d=t(64),h=t(1241),f=t(144),v=t(1201),b=t(46),y=t(79),g=t(228),j=t(783),E=t(2324),O=t(73),w=t(84),x=t(32),C=t(117),P=t(131),k=(t(368),t(369)),D=t(367),q=t(2353),S=t(8),M=t.n(S),L=t(19),Q=t(17);function R(){return(R=Object(L.a)(M.a.mark((function e(a,t,r,n){var c;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a+=1,e.next=3,Q.b.get("/typevehicules?itemsPerPage="+t+"&page="+a+"&nom="+r);case 3:return c=e.sent,e.abrupt("return",c.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var B=t(2401),N=t(60),A=t(787),T=t(1192);const V=y.b().shape({partenaire:y.c().required("Le champs ID est requis"),marque:y.c().required("Le champs Marque est requis"),modele:y.c().required("Le champs Mod\xe8le est requis"),matricule:y.c().required("Le champs Matricule est requis"),typevehicule:y.c().required("Le type de v\xe9hicule est requis"),chauffeur:y.c().required("Le chauffeur est requis")});function z({id:e,levehicule:a,handleFermeture:t,action:i}){var u,o,l;const p=Object(x.useQueryClient)(),h=Object(x.useMutation)(E.a,{onSuccess:()=>{p.invalidateQueries("Vehicules"),W({message:"Enregistrement r\xe9ussi",open:!0,severity:"success",automaticClose:!0})},onError:()=>{p.invalidateQueries("Vehicules"),W({message:"Echec lors de l op\xe9ration",open:!0,severity:"error",automaticClose:!0})}}),v=Object(x.useMutation)(E.c,{onSuccess:()=>{p.invalidateQueries("Vehicules"),W({message:"Mise \xe0 jour r\xe9ussie",open:!0,severity:"success",automaticClose:!0})},onError:()=>{p.invalidateQueries("Vehicules"),W({message:"Echec lors de la mise \xe0 jour",open:!0,severity:"error",automaticClose:!0})}}),y=Object(c.useState)(new Date),S=Object(n.a)(y,2),M=S[0],L=S[1],Q=Object(x.useQuery)(["Chauffeurs",1],()=>Object(q.b)(),{keepPreviousData:!0}),z=Object(x.useQuery)(["Partenaires",1],()=>Object(B.b)(0,100,"",""),{keepPreviousData:!0}),F=Object(x.useQuery)(["Typevehicules",1],()=>function(e,a,t,r){return R.apply(this,arguments)}(0,100,"",""),{keepPreviousData:!0}),I=Object(x.useMutation)(D.a,{onSuccess:()=>{W(Object(r.a)(Object(r.a)({},K),{},{automaticClose:!1,message:"Fichier charg\xe9 sur le serveur",open:!0,severity:"success"}))},onError:()=>{W(Object(r.a)(Object(r.a)({},K),{},{automaticClose:!1,message:"Echec de chargement du fichier sur le serveur",open:!0,severity:"error"}))}}),J=Object(x.useMutation)(D.a,{onSuccess:()=>{W(Object(r.a)(Object(r.a)({},K),{},{automaticClose:!1,message:"Fichier charg\xe9 sur le serveur",open:!0,severity:"success"}))},onError:()=>{W(Object(r.a)(Object(r.a)({},K),{},{automaticClose:!1,message:"Echec de chargement du fichier sur le serveur",open:!0,severity:"error"}))}}),U=Object(c.useState)(a),_=Object(n.a)(U,2),G=_[0],Y=(_[1],Object(c.useState)({severity:"severity",message:"",open:!1,automaticClose:!0})),H=Object(n.a)(Y,2),K=H[0],W=H[1],X=Object(O.c)({resolver:Object(g.yupResolver)(V),defaultValues:Object(r.a)(Object(r.a)({},G),{},{chauffeur:a?"/api/chauffeurs/"+a.chauffeur.id:"/api/chauffeurs/1",typevehicule:a?"/api/typevehicules/"+a.typevehicule.id:"/api/typevehicules/1",partenaire:a?"/api/partenaires/"+a.partenaire.id:"/api/partenaires/1"})}),Z=X.control,$=X.handleSubmit,ee=X.errors,ae=(X.reset,e=>{let a=Object(r.a)(Object(r.a)(Object(r.a)({},G),e),{},{anniversaireassurance:M,photo:I.data,photoassurance:J.data});G?v.mutate(Object(r.a)({},a)):h.mutate(Object(r.a)({},a))});return s.a.createElement("div",null,s.a.createElement(w.a,{message:K.message,severity:K.severity,open:K.open,handleAlertClose:K.automaticClose?t:()=>W(Object(r.a)(Object(r.a)({},K),{},{open:!1}))}),s.a.createElement("form",{onSubmit:$(ae)},s.a.createElement(b.a,{container:!0,spacing:4,direction:"column"},s.a.createElement(b.a,{item:!0},z.isLoading?s.a.createElement(N.a,{message:"chargement des partenaires..."}):s.a.createElement(P.a,{id:"partenaire",name:"partenaire",label:"Choisir le partenaire",table:"partenaire",control:Z,options:z.data["hydra:member"],error:ee.partenaire,valeur:null!==(u=null===G||void 0===G?void 0:G.partenaire)&&void 0!==u?u:""})),s.a.createElement(b.a,{item:!0},Q.isLoading?s.a.createElement(N.a,{message:"chargement des chauffeurs..."}):s.a.createElement(P.a,{id:"chauffeur",name:"chauffeur",label:"Choisir le chauffeur",table:"chauffeur",control:Z,options:Q.data,error:ee.chauffeur,valeur:null!==(o=null===G||void 0===G?void 0:G.chauffeur)&&void 0!==o?o:""})),s.a.createElement(b.a,{item:!0},F.isLoading?s.a.createElement(N.a,{message:"chargement des types de v\xe9hicule..."}):s.a.createElement(P.a,{id:"typevehicule",name:"typevehicule",label:"Choisir le type de v\xe9hicule",table:"typevehicule",control:Z,options:F.data["hydra:member"],error:ee.typevehicule,valeur:null!==(l=null===G||void 0===G?void 0:G.typevehicule)&&void 0!==l?l:""})),s.a.createElement(b.a,{item:!0},s.a.createElement(C.a,{id:"marque",nom:"marque",label:"Marque",valeur:null===G||void 0===G?void 0:G.marque,control:Z,error:ee.marque})),s.a.createElement(b.a,{item:!0},s.a.createElement(C.a,{id:"modele",nom:"modele",label:"Mod\xe8le",valeur:null===G||void 0===G?void 0:G.modele,control:Z,error:ee.modele})),s.a.createElement(b.a,{item:!0},s.a.createElement(C.a,{id:"matricule",nom:"matricule",label:"No d'imatriculation",valeur:null===G||void 0===G?void 0:G.matricule,control:Z,error:ee.matricule})),s.a.createElement(b.a,{item:!0},s.a.createElement(C.a,{id:"numeroassurance",nom:"numeroassurance",label:"Num\xe9ro assurance",valeur:null===G||void 0===G?void 0:G.numeroassurance,control:Z,error:ee.numeroassurance})),s.a.createElement(b.a,{item:!0},s.a.createElement(A.a,{id:"anniversaireassurance",nom:"anniversaireassurance",label:"Anniversaire d'assurance",valeur:new Date,error:ee.anniversaireassurance,control:Z,handledatechange:e=>{L(Object(T.a)(Date.parse(e),"yyyy-MM-dd"))}})),s.a.createElement(b.a,{item:!0},s.a.createElement(k.a,{onUpload:e=>{var a;(a=e)&&I.mutate({fichier:a,objet:"vehicule"})},onSupprimer:()=>{console.log("suppression du fichier attach\xe9")},titre:"Photo du v\xe9hicule (faire glisser ou cliquez ici pour charger)"})),s.a.createElement(b.a,{item:!0},s.a.createElement(k.a,{onUpload:e=>{var a;(a=e)&&J.mutate({fichier:a,objet:"assurance"})},onSupprimer:()=>{console.log("suppression du fichier attach\xe9")},titre:"Photo de l'assurance (faire glisser ou cliquez ici pour charger)"})),s.a.createElement(b.a,{item:!0},s.a.createElement(b.a,{container:!0,alignItems:"center",justify:"space-between"},s.a.createElement(b.a,{item:!0},s.a.createElement(f.a,{color:"primary",variant:"contained",type:"submit",onClick:$(ae)},v.isLoading||h.isLoading?s.a.createElement(j.a,{color:"inherit"}):s.a.createElement(m.a,null,"send"),s.a.createElement("span",{className:"pl-2 capitalize"},"ajout"===i?s.a.createElement(d.a,null,"Enregistrer"):s.a.createElement(d.a,null,"Mettre \xe0 jour")))),s.a.createElement(b.a,{item:!0},s.a.createElement(f.a,{variant:"outlined",color:"secondary",onClick:function(){t()}},"Annuler")))))))}var F=t(204),I=t(230),J=t(300);t(443);a.default=()=>{const e=Object(c.useState)({page:0,rowsPerPage:20,recherche:"",filtre:""}),a=Object(n.a)(e,2),t=a[0],i=a[1],y=Object(x.useQueryClient)(),g=Object(x.useQuery)(["Vehicules",t.page,t.rowsPerPage,t.recherche,t.filtre],()=>Object(E.b)(t.page,t.rowsPerPage,t.recherche,t.filtre),{keepPreviousData:!0}),j=g.isLoading,O=(g.isFetching,g.isError),C=g.error,P=g.data,k=Object(x.useMutation)(E.d,{onSuccess:()=>{G({message:"Suppr\xe9ssion r\xe9ussi",open:!0,severity:"success"})},onError:()=>{G({message:"Echec lors de l op\xe9ration",open:!0,severity:"error"})},onSettled:()=>{y.invalidateQueries("Vehicules")}}),D=Object(c.useState)(null),q=Object(n.a)(D,2),S=q[0],M=q[1],L=Object(c.useState)({mode:"affichage",action:"ajout",affichageTable:!0}),R=Object(n.a)(L,2),B=R[0],A=R[1],V=Object(c.useState)({severity:"severity",message:"",open:!1,handleCloseAlert:()=>ae()}),U=Object(n.a)(V,2),_=U[0],G=U[1],Y=Object(c.useState)("Liste des vehicules"),H=Object(n.a)(Y,2),K=H[0],W=H[1],X=Object(c.useState)(!1),Z=Object(n.a)(X,2),$=Z[0],ee=Z[1],ae=()=>{G(Object(r.a)(Object(r.a)({},w.a),{},{open:!1}))},te=[{name:"id",label:"ID",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>e}},{name:"partenaire",label:"Partenaire",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>e.nom+" "+e.prenom}},{name:"chauffeur",label:"Chauffeur",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>e.nom+" "+e.prenom}},{name:"typevehicule",label:"Type de v\xe9hicule",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>e.nom}},{name:"marque",label:"Marque",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>e}},{name:"modele",label:"Mod\xe8le",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>e}},{name:"matricule",label:"Matricule",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>e}},{name:"numeroassurance",label:"Num\xe9ro assurance",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>e}},{name:"anniversaireassurance",label:"Anniversaire assurance",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>null!=e?Object(T.a)(Date.parse(e),"dd/MM/yyyy"):""}},{name:"photo",label:"Photo",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>s.a.createElement(l.a,{variant:"rounded",src:Q.f+"/fichiers/photosvehicules/"+e})}},{name:"photoassurance",label:"Photo assurance",options:{filter:!1,sort:!1,display:!1,customBodyRender:(e,a,t)=>s.a.createElement(l.a,{src:Q.f+"/fichiers/photosassurances/"+e})}},{name:"action",label:"Actions",options:{filter:!1,sort:!1,customBodyRender:(e,a,t)=>s.a.createElement("div",null,s.a.createElement(p.a,{size:"small",onClick:()=>{(e=>{A({mode:"edition",action:"misajour",affichageTable:!1}),M(e),W("Mise \xe0 jour de vehicule")})({id:a.rowData[0],partenaire:a.rowData[1],chauffeur:a.rowData[2],typevehicule:a.rowData[3],marque:a.rowData[4],modele:a.rowData[5],matricule:a.rowData[6],numeroassurance:a.rowData[7],anniversaireassurance:a.rowData[8],photo:a.rowData[9],photoassurance:a.rowData[10]})}},s.a.createElement(m.a,{color:"primary"},"edit")),s.a.createElement(p.a,{size:"small",onClick:()=>(e=>{ee(!0),M(e)})({id:a.rowData[0]})},s.a.createElement(m.a,{color:"error"},"delete")),s.a.createElement(p.a,{size:"small",onClick:()=>(a.rowData[0],void console.log("affichage de details"))},s.a.createElement(m.a,null,"arrow_right_alt")))}}];return s.a.createElement("div",{className:"m-sm-30"},s.a.createElement(w.a,{message:_.message,severity:_.severity,open:_.open,handleAlertClose:ae}),s.a.createElement("div",{className:"mb-sm-30"},s.a.createElement(F.a,{routeSegments:[{name:"Gestion des v\xe9hicules"}]})),s.a.createElement("div",{className:"mb-sm-30"},s.a.createElement(d.a,{variant:"h4"},K)),"affichage"===B.mode?s.a.createElement(h.a,{in:B.affichageTable,direction:"right",unmountOnExit:!0},s.a.createElement("div",null,s.a.createElement(f.a,{className:"mb-4",variant:"contained",color:"primary",onClick:()=>(A({mode:"edition",action:"ajout",affichageTable:!1}),M(null),void W("Nouveau v\xe9hicule"))},"Nouveau v\xe9hicule"),j?s.a.createElement(N.a,{message:"Chargement des donn\xe9es",type:"info"}):O?s.a.createElement(N.a,{message:"Erreur lors du chargement des donn\xe9es::"+C,type:"error"}):s.a.createElement(J.a,{tag:"div",blocking:!1},s.a.createElement(u.a,{title:K,data:P["hydra:member"],columns:te,options:Object(r.a)(Object(r.a)({},o.a),{},{serverSide:!0,count:P["hydra:totalItems"],rowsPerPageOptions:[20,30,50],rowsPerPage:t.rowsPerPage,onChangePage:e=>(e=>{i(Object(r.a)(Object(r.a)({},t),{},{page:e})),y.invalidateQueries("Vehicules")})(e),onChangeRowsPerPage:e=>(e=>{i(Object(r.a)(Object(r.a)({},t),{},{rowsPerPage:e})),console.log("marquebre de ligne par page:"+e),y.invalidateQueries("Vehicules")})(e),onSearchChange:e=>(e=>{var a;i(Object(r.a)(Object(r.a)({},t),{},{recherche:null!==e&&void 0!==e?e:""})),console.log(null!==(a="texte a chercher"+e)&&void 0!==a?a:""),y.invalidateQueries("Vehicules")})(e),onFilterChange:()=>{console.log("le filtre a chang\xe9")}})})),s.a.createElement(v.a,{className:"w-full overflow-auto",elevation:8},s.a.createElement(I.a,{open:$,onConfirmDialogClose:()=>{ee(!1)},onYesClick:()=>{ee(!1),k.mutate(S)},text:"Confirmez la suppression de "+(null===S||void 0===S?void 0:S.name)})))):s.a.createElement(b.a,{container:!0,spacing:6,alignContent:"center",justify:"center"},s.a.createElement(b.a,{item:!0,lg:6,md:6,sm:12,xs:12},s.a.createElement(v.a,{className:"px-6 pt-2 pb-4"},s.a.createElement(z,{action:B.action,levehicule:S,handleFermeture:()=>{A({mode:"affichage",action:"nouveau",affichageTable:!0}),W("Liste des vehicules")}})))))}}}]);