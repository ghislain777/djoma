(this["webpackJsonpmatx-react-pro"]=this["webpackJsonpmatx-react-pro"]||[]).push([[61],{2328:function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return l})),a.d(t,"c",(function(){return m})),a.d(t,"d",(function(){return p}));var n=a(8),r=a.n(n),i=a(19),s=a(17);function c(e,t,a,n){return o.apply(this,arguments)}function o(){return(o=Object(i.a)(r.a.mark((function e(t,a,n,i){var c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t+=1,e.next=3,s.b.get("/caisses?itemsPerPage="+a+"&page="+t+"&id="+n);case 3:return c=e.sent,e.abrupt("return",c.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function l(e){return u.apply(this,arguments)}function u(){return(u=Object(i.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.b.post("/caisses",t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return d.apply(this,arguments)}function d(){return(d=Object(i.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.b.put("/caisses/"+t.id,t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return v.apply(this,arguments)}function v(){return(v=Object(i.a)(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.b.delete("/caisses/"+t.id,{method:"DELETE",herdears:{Accept:"application/json"},data:t.id});case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},3159:function(e,t,a){"use strict";a.r(t);var n=a(6),r=a(12),i=a(26),s=a(0),c=a.n(s),o=a(229),l=a.n(o),u=a(231),m=a(224),d=a(606),p=a(64),v=a(1241),b=a(144),f=a(1201),h=(a(95),a(79)),g=a(228),j=a(46),y=a(1204),E=a(1203),O=a(1202),w=a(783),x=a(8),C=a.n(x),P=a(19),k=a(17);function R(){return(R=Object(P.a)(C.a.mark((function e(t,a,n,r){var i;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t+=1,e.next=3,k.b.get("/ravitaillements?itemsPerPage="+a+"&page="+t+"&id="+n);case 3:return i=e.sent,e.abrupt("return",i.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e){return M.apply(this,arguments)}function M(){return(M=Object(P.a)(C.a.mark((function e(t){var a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.b.post("/ravitaillements",Object(n.a)(Object(n.a)({},t),{},{caisse:"/api/caisses/1"}));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e){return Q.apply(this,arguments)}function Q(){return(Q=Object(P.a)(C.a.mark((function e(t){var a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.b.put("/ravitaillements/"+t.id,t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(e){return N.apply(this,arguments)}function N(){return(N=Object(P.a)(C.a.mark((function e(t){var a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.b.delete("/ravitaillements/"+t.id,{method:"DELETE",herdears:{Accept:"application/json"},data:t.id});case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var I=a(73),A=a(84),T=a(32),B=a(117),z=(a(131),a(368),a(369),a(60)),F=(a(265),a(444),a(1196)),q=(a(367),a(2328));const J=h.b().shape({montant:h.a().required("Montant requis").positive("Le Montant doit \xeatre positif").integer("Le Montant doit \xeatre un nombre entier")});function W({id:e,leravitaillement:t,handleFermeture:a,action:i}){var o,l,u;const v=Object(T.useQueryClient)(),h=Object(T.useMutation)(S,{onSuccess:()=>{v.invalidateQueries("Ravitaillements"),N({message:"Enregistrement r\xe9ussi",open:!0,severity:"success",automaticClose:!0})},onError:()=>{v.invalidateQueries("Ravitaillements"),N({message:"Echec lors de l op\xe9ration",open:!0,severity:"error",automaticClose:!0})}}),x=Object(T.useMutation)(D,{onSuccess:()=>{v.invalidateQueries("Ravitaillements"),N({message:"Mise \xe0 jour r\xe9ussie",open:!0,severity:"success",automaticClose:!0})},onError:()=>{v.invalidateQueries("Ravitaillements"),N({message:"Echec lors de la mise \xe0 jour",open:!0,severity:"error",automaticClose:!0})}}),C=(Object(T.useQuery)(["Caisses",1],()=>Object(q.b)(0,100,"",""),{keepPreviousData:!0}),Object(s.useState)(t)),P=Object(r.a)(C,2),R=P[0],M=(P[1],Object(s.useState)({severity:"severity",message:"",open:!1,automaticClose:!0})),Q=Object(r.a)(M,2),L=Q[0],N=Q[1],z=Object(I.c)({resolver:Object(g.yupResolver)(J),defaultValues:Object(n.a)(Object(n.a)({},t),{},{id:null!==(o=null===t||void 0===t?void 0:t.id)&&void 0!==o?o:"",caisse:t?"/api/caisses/"+t.caisse.id:"/api/caisses/1",dateravitallement:null!==(l=null===t||void 0===t?void 0:t.dateravitallement)&&void 0!==l?l:new Date,commentaire:null!==(u=null===t||void 0===t?void 0:t.commentaire)&&void 0!==u?u:""})}),W=z.control,_=z.handleSubmit,V=z.errors,Y=(z.reset,Object(s.useState)({})),G=Object(r.a)(Y,2),H=G[0],K=(G[1],e=>{let t=Object(n.a)(Object(n.a)(Object(n.a)({},R),e),H);R?x.mutate(Object(n.a)({},t)):h.mutate(Object(n.a)({},t))});function U(){a()}return c.a.createElement("div",null,c.a.createElement(A.a,{message:L.message,severity:L.severity,open:L.open,handleAlertClose:L.automaticClose?a:()=>N(Object(n.a)(Object(n.a)({},L),{},{open:!1}))}),c.a.createElement(j.a,{container:!0,spacing:1,justify:"center"},c.a.createElement(j.a,{item:!0,lg:6,md:6,sm:12,xs:12,justify:"center"},c.a.createElement(F.a,{theme:Object(k.a)()},c.a.createElement(f.a,null,c.a.createElement(y.a,{action:c.a.createElement(m.a,{"aria-label":"",onClick:U},"x"),title:"ajout"===i?"Nouveau ravitaillement":"Mise \xe0 jour de ravitaillement",subheader:""}),c.a.createElement(E.a,{className:" px-6 pt-6 pb-6"}," ",c.a.createElement("form",{onSubmit:_(K)},c.a.createElement(j.a,{container:!0,spacing:4,direction:"column"},c.a.createElement(j.a,{item:!0},c.a.createElement(B.a,{id:"montant",nom:"montant",label:"Montant",valeur:null===R||void 0===R?void 0:R.montant,control:W,error:V.montant})),c.a.createElement(j.a,{item:!0},c.a.createElement(B.a,{id:"commentaire",nom:"commentaire",label:"Commentaire",valeur:null===R||void 0===R?void 0:R.commentaire,control:W,error:V.commentaire,multiline:!0,rows:4}))))),c.a.createElement(O.a,null,c.a.createElement(j.a,{container:!0,alignItems:"center",justify:"space-between"},c.a.createElement(j.a,{item:!0},c.a.createElement(b.a,{color:"primary",variant:"contained",type:"submit",onClick:_(K)},x.isLoading||h.isLoading?c.a.createElement(w.a,{color:"inherit"}):c.a.createElement(d.a,null,"send"),c.a.createElement("span",{className:"pl-2 capitalize"},"ajout"===i?c.a.createElement(p.a,null,"Enregistrer"):c.a.createElement(p.a,null,"Mettre \xe0 jour")))),c.a.createElement(j.a,{item:!0},c.a.createElement(b.a,{variant:"outlined",color:"secondary",onClick:U},"Annuler")))))))))}var _=a(204),V=a(230),Y=a(300),G=(a(443),a(1192)),H=a(2285),K=(a(3),a(110));Object(K.a)(e=>{e.palette,Object(i.a)(e,["palette"]);return{userMenu:{display:"flex",alignItems:"center",cursor:"pointer",borderRadius:24,padding:4,"& span":{margin:"0 8px"}},menuItem:{display:"flex",alignItems:"center",minWidth:185},userMenu:{display:"flex",alignItems:"center",cursor:"pointer",borderRadius:24,padding:4,"& span":{margin:"0 8px"}},menuItem:{display:"flex",alignItems:"center",minWidth:185}}});t.default=()=>{const e=Object(s.useState)({page:0,rowsPerPage:20,recherche:"",filtre:""}),t=Object(r.a)(e,2),a=t[0],i=t[1],o=Object(T.useQueryClient)(),h=Object(T.useQuery)(["Ravitaillements",a.page,a.rowsPerPage,a.recherche,a.filtre],()=>function(e,t,a,n){return R.apply(this,arguments)}(a.page,a.rowsPerPage,a.recherche,a.filtre),{keepPreviousData:!0}),g=h.isLoading,j=(h.isFetching,h.isError),y=h.error,E=h.data,O=Object(T.useMutation)(L,{onSuccess:()=>{q({message:"Suppr\xe9ssion r\xe9ussi",open:!0,severity:"success"})},onError:()=>{q({message:"Echec lors de l op\xe9ration",open:!0,severity:"error"})},onSettled:()=>{o.invalidateQueries("Ravitaillements")}}),w=Object(s.useState)(null),x=Object(r.a)(w,2),C=x[0],P=x[1],S=Object(s.useState)({mode:"affichage",action:"ajout",affichageTable:!0}),M=Object(r.a)(S,2),D=M[0],Q=M[1],N=Object(s.useState)({severity:"severity",message:"",open:!1,handleCloseAlert:()=>ae()}),I=Object(r.a)(N,2),B=I[0],q=I[1],J=Object(s.useState)("Liste des ravitaillements"),K=Object(r.a)(J,2),U=K[0],X=K[1],Z=Object(s.useState)(!1),$=Object(r.a)(Z,2),ee=$[0],te=$[1],ae=()=>{q(Object(n.a)(Object(n.a)({},A.a),{},{open:!1}))},ne=[{name:"id",label:"ID",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>e}},{name:"caisse",label:"caisse",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>e.description}},{name:"dateravitallement",label:"Date",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>null==e?" ":Object(G.a)(Object(H.a)(e),"dd/MM/yyyy hh:mm")}},{name:"montant",label:"Montant",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>e.toLocaleString("fr-FR")}},{name:"commentaire",label:"Commentaire",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>e}},{name:"action",label:"Actions",options:{filter:!1,sort:!1,display:"excluded",customBodyRender:(e,t,a)=>c.a.createElement("div",null,c.a.createElement(m.a,{size:"small",onClick:()=>{(e=>{Q({mode:"edition",action:"misajour",affichageTable:!1}),P(e),X("Mise \xe0 jour de ravitaillement")})({id:t.rowData[0],caisse:t.rowData[1],dateravitallement:t.rowData[2],montant:t.rowData[3],commentaire:t.rowData[4]})}},c.a.createElement(d.a,{color:"primary"},"edit")),c.a.createElement(m.a,{size:"small",onClick:()=>(e=>{te(!0),P(e)})({id:t.rowData[0]})},c.a.createElement(d.a,{color:"error"},"delete")),c.a.createElement(m.a,{size:"small",onClick:()=>(t.rowData[0],void console.log("affichage de details"))},c.a.createElement(d.a,null,"arrow_right_alt")))}}];return c.a.createElement("div",{className:"m-sm-30"},c.a.createElement(A.a,{message:B.message,severity:B.severity,open:B.open,handleAlertClose:ae}),c.a.createElement("div",{className:"mb-sm-30"},c.a.createElement(_.a,{routeSegments:[{name:"Ravitaillements de caisse"}]})),c.a.createElement("div",{className:"mb-sm-30"},c.a.createElement(p.a,{variant:"h4"},U)),"affichage"===D.mode?c.a.createElement(v.a,{in:D.affichageTable,direction:"right",unmountOnExit:!0},c.a.createElement("div",null,c.a.createElement(b.a,{className:"mb-4",variant:"contained",color:"primary",onClick:()=>(Q({mode:"edition",action:"ajout",affichageTable:!1}),P(null),void X("Nouveau ravitaillement"))},"Nouveau ravitaillement"),g?c.a.createElement(z.a,{message:"Chargement des donn\xe9es",type:"info"}):j?c.a.createElement(z.a,{message:"Erreur lors du chargement des donn\xe9es::"+y,type:"error"}):c.a.createElement(Y.a,{tag:"div",blocking:!1},c.a.createElement(F.a,{theme:Object(k.a)()},c.a.createElement(l.a,{title:U,data:E["hydra:member"],columns:ne,options:Object(n.a)(Object(n.a)({},u.a),{},{serverSide:!0,count:E["hydra:totalItems"],rowsPerPageOptions:[20,30,50],rowsPerPage:a.rowsPerPage,onChangePage:e=>(e=>{i(Object(n.a)(Object(n.a)({},a),{},{page:e})),o.invalidateQueries("Ravitaillements")})(e),onChangeRowsPerPage:e=>(e=>{i(Object(n.a)(Object(n.a)({},a),{},{rowsPerPage:e})),console.log("idbre de ligne par page:"+e),o.invalidateQueries("Ravitaillements")})(e),onSearchChange:e=>(e=>{var t;i(Object(n.a)(Object(n.a)({},a),{},{recherche:null!==e&&void 0!==e?e:""})),console.log(null!==(t="texte a chercher"+e)&&void 0!==t?t:""),o.invalidateQueries("Ravitaillements")})(e),onFilterChange:()=>{console.log("le filtre a chang\xe9")}})}))),c.a.createElement(f.a,{className:"w-full overflow-auto",elevation:8},c.a.createElement(V.a,{open:ee,onConfirmDialogClose:()=>{te(!1)},onYesClick:()=>{te(!1),O.mutate(C)},text:"Confirmez la suppression de "+(null===C||void 0===C?void 0:C.name)})))):c.a.createElement(W,{action:D.action,leravitaillement:C,handleFermeture:()=>{Q({mode:"affichage",action:"nouveau",affichageTable:!0}),X("Liste des ravitaillements")}}))}}}]);