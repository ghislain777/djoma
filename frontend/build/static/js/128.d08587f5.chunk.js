(this["webpackJsonpmatx-react-pro"]=this["webpackJsonpmatx-react-pro"]||[]).push([[128],{3145:function(e,t,a){"use strict";a.r(t);var r=a(6),s=a(12),n=a(0),i=a.n(n),o=a(229),l=a.n(o),c=a(231),u=a(224),m=a(606),d=a(64),p=a(46),g=a(1201),v=a(262),b=a(434),y=a(568),E=a(1241),h=a(79),f=a(228),j=a(144),M=a(783),O=a(8),R=a.n(O),x=a(19),q=a(17);function C(){return(C=Object(x.a)(R.a.mark((function e(t,a,r,s,n){var i;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t+=1,e.next=3,q.b.get("/messageins?itemsPerPage="+a+"&page="+t+"&envoyeur="+r+"&emission="+n);case 3:return i=e.sent,e.abrupt("return",i.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e){return P.apply(this,arguments)}function P(){return(P=Object(x.a)(R.a.mark((function e(t){var a;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q.b.post("/messageins",t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e){return L.apply(this,arguments)}function L(){return(L=Object(x.a)(R.a.mark((function e(t){var a;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q.b.put("/messageins/"+t.idMessagein,t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(e){return D.apply(this,arguments)}function D(){return(D=Object(x.a)(R.a.mark((function e(t){var a;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q.b.delete("/messageins/"+t.idMessagein,{method:"DELETE",herdears:{Accept:"application/json"},data:t.idMessagein});case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var B=a(73),k=a(84),Q=a(32),N=a(117),T=(a(131),a(368),a(369),a(367),a(60));const A=h.b().shape({idMessagein:h.c().required("Le champs ID est requis"),envoyeur:h.c().required("Le champs Envoyeur est requis"),destinataire:h.c().required("Le champs Destinataire est requis"),texteMessage:h.c().required("Le champs Message est requis"),typeMessage:h.c().required("Le champs Type message est requis"),operateurMessage:h.c().required("Le champs Operateur est requis"),statutMessage:h.c().required("Le champs Statut est requis"),dateReception:h.c().required("Le champs Date de reception est requis"),heureReception:h.c().required("Le champs Heure de reception est requis"),indiceSms:h.c().required("Le champs indice sms est requis"),commentaire:h.c().required("Le champs Commentaires est requis"),idMessageRecu:h.c().required("Le champs ID reception est requis"),portReception:h.c().required("Le champs Port de reception est requis"),utilisateurIdUtilisateur:h.c().required("Le champs utilisateur est requis"),emissionId:h.c().required("Le champs ID est requis")});function U({id:e,lemessagein:t,handleFermeture:a,action:o}){const l=Object(Q.useQueryClient)(),c=Object(Q.useMutation)(w,{onSuccess:()=>{l.invalidateQueries("Messageins"),O({message:"Enregistrement r\xe9ussi",open:!0,severity:"success",automaticClose:!0})},onError:()=>{l.invalidateQueries("Messageins"),O({message:"Echec lors de l op\xe9ration",open:!0,severity:"error",automaticClose:!0})}}),u=Object(Q.useMutation)(S,{onSuccess:()=>{l.invalidateQueries("Messageins"),O({message:"Mise \xe0 jour r\xe9ussie",open:!0,severity:"success",automaticClose:!0})},onError:()=>{l.invalidateQueries("Messageins"),O({message:"Echec lors de la mise \xe0 jour",open:!0,severity:"error",automaticClose:!0})}}),g=Object(n.useState)(t),v=Object(s.a)(g,2),b=v[0],y=(v[1],Object(n.useState)({severity:"severity",message:"",open:!1,automaticClose:!0})),E=Object(s.a)(y,2),h=E[0],O=E[1],R=Object(B.c)({resolver:Object(f.yupResolver)(A)}),x=R.control,q=R.handleSubmit,C=R.errors,P=(R.reset,e=>{let t=Object(r.a)(Object(r.a)({},b),e);b?u.mutate(Object(r.a)({},t)):c.mutate(Object(r.a)({},t))});return i.a.createElement("div",null,i.a.createElement(k.a,{message:h.message,severity:h.severity,open:h.open,handleAlertClose:h.automaticClose?a:()=>O(Object(r.a)(Object(r.a)({},h),{},{open:!1}))}),i.a.createElement("form",{onSubmit:q(P)},i.a.createElement(p.a,{container:!0,spacing:4,direction:"column"},i.a.createElement(p.a,{item:!0},i.a.createElement(N.a,{id:"envoyeur",nom:"envoyeur",label:"Envoyeur",valeur:null===b||void 0===b?void 0:b.envoyeur,control:x,error:C.envoyeur})),i.a.createElement(p.a,{item:!0},i.a.createElement(N.a,{id:"destinataire",nom:"destinataire",label:"Destinataire",valeur:null===b||void 0===b?void 0:b.destinataire,control:x,error:C.destinataire})),i.a.createElement(p.a,{item:!0},i.a.createElement(N.a,{id:"texteMessage",nom:"texteMessage",label:"Message",valeur:null===b||void 0===b?void 0:b.texteMessage,control:x,error:C.texteMessage})),i.a.createElement(p.a,{item:!0},i.a.createElement(N.a,{id:"typeMessage",nom:"typeMessage",label:"Type message",valeur:null===b||void 0===b?void 0:b.typeMessage,control:x,error:C.typeMessage})),i.a.createElement(p.a,{item:!0},i.a.createElement(N.a,{id:"operateurMessage",nom:"operateurMessage",label:"Operateur",valeur:null===b||void 0===b?void 0:b.operateurMessage,control:x,error:C.operateurMessage})),i.a.createElement(p.a,{item:!0},i.a.createElement(N.a,{id:"statutMessage",nom:"statutMessage",label:"Statut",valeur:null===b||void 0===b?void 0:b.statutMessage,control:x,error:C.statutMessage})),i.a.createElement(p.a,{item:!0},i.a.createElement(N.a,{id:"dateReception",nom:"dateReception",label:"Date de reception",valeur:null===b||void 0===b?void 0:b.dateReception,control:x,error:C.dateReception})),i.a.createElement(p.a,{item:!0},i.a.createElement(N.a,{id:"commentaire",nom:"commentaire",label:"Commentaires",valeur:null===b||void 0===b?void 0:b.commentaire,control:x,error:C.commentaire})),i.a.createElement(p.a,{item:!0},i.a.createElement(N.a,{id:"idMessageRecu",nom:"idMessageRecu",label:"ID reception",valeur:null===b||void 0===b?void 0:b.idMessageRecu,control:x,error:C.idMessageRecu})),i.a.createElement(p.a,{item:!0},i.a.createElement(N.a,{id:"portReception",nom:"portReception",label:"Port de reception",valeur:null===b||void 0===b?void 0:b.portReception,control:x,error:C.portReception})),i.a.createElement(p.a,{item:!0},i.a.createElement(N.a,{id:"utilisateurIdUtilisateur",nom:"utilisateurIdUtilisateur",label:"utilisateur",valeur:null===b||void 0===b?void 0:b.utilisateurIdUtilisateur,control:x,error:C.utilisateurIdUtilisateur})),i.a.createElement(p.a,{item:!0},i.a.createElement(N.a,{id:"emissionId",nom:"emissionId",label:"ID",valeur:null===b||void 0===b?void 0:b.emissionId,control:x,error:C.emissionId})),i.a.createElement(p.a,{item:!0},i.a.createElement(p.a,{container:!0,alignItems:"center",justify:"space-between"},i.a.createElement(p.a,{item:!0},i.a.createElement(j.a,{color:"primary",variant:"contained",type:"submit",onClick:q(P)},u.isLoading||c.isLoading?i.a.createElement(M.a,{color:"inherit"}):i.a.createElement(m.a,null,"send"),i.a.createElement("span",{className:"pl-2 capitalize"},"ajout"===o?i.a.createElement(d.a,null,"Enregistrer"):i.a.createElement(d.a,null,"Mettre \xe0 jour")))),i.a.createElement(p.a,{item:!0},i.a.createElement(j.a,{variant:"outlined",color:"secondary",onClick:function(){a()}},"Annuler")))))))}var F=a(204),z=a(230),H=a(300),J=(a(443),a(1192));function _(){return(_=Object(x.a)(R.a.mark((function e(t,a,r,s){var n;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t+=1,e.next=3,q.b.get("/emissions?itemsPerPage="+a+"&page="+t+"&nom="+r);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t.default=()=>{const e=Object(n.useState)({page:0,rowsPerPage:50,recherche:"",filtre:"",emission:""}),t=Object(s.a)(e,2),a=t[0],o=t[1],h=Object(Q.useQueryClient)(),f=Object(Q.useQuery)(["Messageins",a.page,a.rowsPerPage,a.recherche,a.filtre,a.emission],()=>function(e,t,a,r,s){return C.apply(this,arguments)}(a.page,a.rowsPerPage,a.recherche,a.filtre,a.emission),{keepPreviousData:!0}),j=f.isLoading,M=(f.isFetching,f.isError),O=f.error,R=f.data,x=Object(Q.useQuery)(["Emissions",1],()=>function(e,t,a,r){return _.apply(this,arguments)}(0,100,"",""),{keepPreviousData:!0}),q=Object(Q.useMutation)(I,{onSuccess:()=>{K({message:"Suppr\xe9ssion r\xe9ussi",open:!0,severity:"success"})},onError:()=>{K({message:"Echec lors de l op\xe9ration",open:!0,severity:"error"})},onSettled:()=>{h.invalidateQueries("Messageins")}}),w=Object(n.useState)(null),P=Object(s.a)(w,2),S=P[0],L=(P[1],Object(n.useState)({mode:"affichage",action:"ajout",affichageTable:!0})),D=Object(s.a)(L,2),B=D[0],N=D[1],A=Object(n.useState)({severity:"severity",message:"",open:!1,handleCloseAlert:()=>re()}),Y=Object(s.a)(A,2),G=Y[0],K=Y[1],V=Object(n.useState)("Liste des messages re\xe7us"),W=Object(s.a)(V,2),X=W[0],Z=W[1],$=Object(n.useState)(!1),ee=Object(s.a)($,2),te=ee[0],ae=ee[1],re=()=>{K(Object(r.a)(Object(r.a)({},k.a),{},{open:!1}))},se=[{name:"idMessagein",label:"ID",options:{filter:!1,sort:!1,display:"excluded",customBodyRender:(e,t,a)=>e}},{name:"envoyeur",label:"Envoyeur",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>e}},{name:"texteMessage",label:"Message",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>e}},{name:"destinataire",label:"Destinataire",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>e}},{name:"dateReception",label:"Date ",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>Object(J.a)(Date.parse(e),"dd/MM/yyyy")}},{name:"heureReception",label:"Heure",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,a)=>e}},{name:"typeMessage",label:"Type message",options:{filter:!1,sort:!1,display:"excluded",customBodyRender:(e,t,a)=>e}},{name:"operateurMessage",label:"Operateur",options:{filter:!1,sort:!1,display:"excluded",customBodyRender:(e,t,a)=>e}},{name:"statutMessage",label:"Statut",options:{filter:!1,sort:!1,display:"excluded",customBodyRender:(e,t,a)=>e}},{name:"indiceSms",label:"indice sms",options:{filter:!1,sort:!1,display:"excluded",customBodyRender:(e,t,a)=>e}},{name:"commentaire",label:"Commentaires",options:{filter:!1,sort:!1,display:"excluded",customBodyRender:(e,t,a)=>e}},{name:"idMessageRecu",label:"ID reception",options:{filter:!1,sort:!1,display:"excluded",customBodyRender:(e,t,a)=>e}},{name:"portReception",label:"Port de reception",options:{filter:!1,sort:!1,display:!1,customBodyRender:(e,t,a)=>e}},{name:"utilisateurIdUtilisateur",label:"utilisateur",options:{filter:!1,sort:!1,display:!1,customBodyRender:(e,t,a)=>e}},{name:"emission",label:"Emission",options:{filter:!0,sort:!1,display:!0,customBodyRender:(e,t,a)=>{var r;return null!==(r=null===e||void 0===e?void 0:e.nom)&&void 0!==r?r:""}}},{name:"action",label:"Actions",options:{filter:!1,sort:!1,display:!1,customBodyRender:(e,t,a)=>i.a.createElement("div",null,i.a.createElement(u.a,{size:"small",onClick:()=>(t.rowData[0],void console.log("affichage de details"))},i.a.createElement(m.a,null,"arrow_right_alt")))}}];return i.a.createElement("div",{className:"m-sm-30"},i.a.createElement(k.a,{message:G.message,severity:G.severity,open:G.open,handleAlertClose:re}),i.a.createElement("div",{className:"mb-sm-30"},i.a.createElement(F.a,{routeSegments:[{name:"Historique des sms"}]})),i.a.createElement("div",{className:"mb-sm-30"},i.a.createElement(d.a,{variant:"h4"},X)),i.a.createElement(p.a,{container:!0,spacing:3,className:" pt-2 pb-4"},i.a.createElement(p.a,{item:!0,lg:6,md:6,sm:12,xs:12},i.a.createElement(g.a,{className:"px-6 pt-2 pb-4"},i.a.createElement(p.a,{container:!0,spacing:4,direction:"row"},i.a.createElement(p.a,{item:!0},i.a.createElement(d.a,{variant:"h6"},"Filtrer le tableau")),i.a.createElement(p.a,{item:!0},x.isLoading?i.a.createElement(T.a,{message:"chargement des \xe9missions"}):i.a.createElement(v.a,null,i.a.createElement(b.a,{variant:"outlined",displayEmpty:!0,id:"emission",value:a.emission,onChange:e=>{console.log(e.target.value),o(Object(r.a)(Object(r.a)({},a),{},{emission:e.target.value})),h.invalidateQueries("Messageins")}},i.a.createElement(y.a,{value:""},"Choisir une \xe9mission pour filtrer"),x.data["hydra:member"].map(e=>i.a.createElement(y.a,{key:e.id,value:e.id},e.nom," (",e.motcle,")"))))))))),i.a.createElement(p.a,{item:!0}),"affichage"===B.mode?i.a.createElement(E.a,{in:B.affichageTable,direction:"right",unmountOnExit:!0},i.a.createElement("div",null,j?i.a.createElement(T.a,{message:"Chargement des donn\xe9es",type:"info"}):M?i.a.createElement(T.a,{message:"Erreur lors du chargement des donn\xe9es::"+O,type:"error"}):i.a.createElement(H.a,{tag:"div",blocking:!1},i.a.createElement(l.a,{title:X,data:R["hydra:member"],columns:se,options:Object(r.a)(Object(r.a)({},c.a),{},{serverSide:!0,count:R["hydra:totalItems"],rowsPerPageOptions:[50,100,200],rowsPerPage:a.rowsPerPage,onChangePage:e=>(e=>{o(Object(r.a)(Object(r.a)({},a),{},{page:e})),h.invalidateQueries("Messageins")})(e),onChangeRowsPerPage:e=>(e=>{o(Object(r.a)(Object(r.a)({},a),{},{rowsPerPage:e})),console.log("envoyeurbre de ligne par page:"+e),h.invalidateQueries("Messageins")})(e),onSearchChange:e=>(e=>{var t;o(Object(r.a)(Object(r.a)({},a),{},{recherche:null!==e&&void 0!==e?e:""})),console.log(null!==(t="texte a chercher"+e)&&void 0!==t?t:""),h.invalidateQueries("Messageins")})(e),onFilterChange:()=>{console.log("le filtre a chang\xe9")}})})),i.a.createElement(g.a,{className:"w-full overflow-auto",elevation:8},i.a.createElement(z.a,{open:te,onConfirmDialogClose:()=>{ae(!1)},onYesClick:()=>{ae(!1),q.mutate(S)},text:"Confirmez la suppression de "+(null===S||void 0===S?void 0:S.name)})))):i.a.createElement(p.a,{container:!0,spacing:6,alignContent:"center",justify:"center"},i.a.createElement(p.a,{item:!0,lg:6,md:6,sm:12,xs:12},i.a.createElement(g.a,{className:"px-6 pt-2 pb-4"},i.a.createElement(U,{action:B.action,lemessagein:S,handleFermeture:()=>{N({mode:"affichage",action:"nouveau",affichageTable:!0}),Z("Liste des messages re\xe7us")}})))))}}}]);